myfunction <- function(x) {
y <- rnorm(100)
}
clc
setwd("~/Documents/Time Series Pred 413/week 5/TS5")
setwd("~/Documents/Time Series Pred 413/week 5/TS5")
library(tseries)
library(fBasics)
unlink('Documents/Time Series Pred 413/week 5/TS5/TS5s1Herena_cache', recursive = TRUE)
library(rugarch)
library(rmgarch)
install.packages("rugarch")
library(rugarch)
library(rmgarch)
install.packages("rmgarch")
install.packages(rugarch)
install.packages("rugarch")
library(rugarch)
install.packages("rgl")
library(rgl)
install.packages("rugarch")
library(rugarch)
install.packages("rmgarch")
install.packages("rmgarch")
install.packages("method")
install.packages("rugarch")
library(rugarch)
install.packages("rmgarch")
install.packages("methods")
install.packages("methods")
install.packages("methods")
install.packages("methods")
install.packages("rmgarch")
install.packages("neuralnets")
setwd("~/Documents")
setwd("~/Documents/Text Analysis Pred 453/P454_TextCluster")
knitr::opts_chunk$set(echo = TRUE)
install.packages("tm")  # for text mining
install.packages("SnowballC") # for text stemming
library("wordcloud")
library("Wordcloud")
install.packages("wordcloud") # word-cloud generator
install.packages("RColorBrewer") # color palettes
library("tm")
library("SnowballC")
library("wordcloud")
library("RColorBrewer")
setwd("~/Documents/Text Analysis Pred 453/P454_TextCluster/Code_Example")
text <- readLines("MLK_Dream.txt")
text <- readLines("MLK_Dream")
text <- readLines("MLK_Dream.txt")
text <- readLines("MLK_Dream.txt")
text <- readLines("/MLK_Dream.txt")
text <- readLines(file.choose())
text <- readLines(file.choose())
text
text <- readLines("MLK_Dream.txt")
setwd("~/Documents/Text Analysis Pred 453/P454_TextCluster/Code_Example/")
setwd("~/Documents/Text Analysis Pred 453/P454_TextCluster/Code_Example/")
setwd("~/Documents/Text Analysis Pred 453/P454_TextCluster/Code_Example/")
text <- readLines("/MLK_Dream.txt")
text <- readLines("MLK_Dream.txt")
setwd("~/Documents/Text Analysis Pred 453/P454_TextCluster/Code_Example")
text <- readLines('/Users/ricardoherena/Documents/Text Analysis Pred 453/P454_TextCluster/Code_Example/MLK_Dream.txt')
text <- readLines('/Users/ricardoherena/Documents/Text Analysis Pred 453/P454_TextCluster/Code_Example/MLK_Dream.txt')
?readLines
text <- readLines('/Users/ricardoherena/Documents/Text Analysis Pred 453/P454_TextCluster/Code_Example/MLK_Dream.txt', skipNul = T)
text
text <- readLines('/Users/ricardoherena/Documents/Text Analysis Pred 453/P454_TextCluster/Code_Example/MLK_Dream.txt', skipNul = T)
text <- readLines('/Users/ricardoherena/Documents/Text Analysis Pred 453/P454_TextCluster/Code_Example/MLK_Dream.txt', skipNul = F)
text
getwd()
getwd()+'stuff'
paste(getwd(),'MLK_Dream.txt')
paste(getwd(),'/','MLK_Dream.txt')
paste(getwd(),'/','MLK_Dream.txt', collp)
paste(getwd(),'/','MLK_Dream.txt', collapse = '')
paste(getwd(),'/','MLK_Dream.txt', collapse = ' ')
paste(getwd(),'/','MLK_Dream.txt', collapse = '')
text <- readLines(paste(getwd(),'/','MLK_Dream.txt', collapse = ''), skipNul = F)
?paste
text <- readLines(paste(getwd(),'/','MLK_Dream.txt', sep = ''), skipNul = F)
paste(getwd(),'/','MLK_Dream.txt', sep = '')
fname <- paste(getwd(),'/','MLK_Dream.txt', sep = '')
text <- readLines(fname, skipNul = F)
setwd("~/Documents/Text Analysis Pred 453/P454_TextCluster/Code_Example")
knitr::opts_chunk$set(echo = TRUE)
library("tm")
library("SnowballC")
library("wordcloud")
library("RColorBrewer")
setwd("~/Documents/Text Analysis Pred 453/P454_TextCluster/Code_Example")
setwd("~/Documents/Text Analysis Pred 453/P454_TextCluster/Code_Example")
getwd(),'/','MLK_Dream.txt'
fname <- paste(getwd(),'/','MLK_Dream.txt', sep = '')
fname
text <- readLines(fname, skipNul = F)
docs <- Corpus(VectorSource(text))
inspect(docs)
docs <- tm_map(docs, stripWhitespace)
docs
inspect(docs)
docs <- tm_map(docs, stripWhitespace)
dtm <- TermDocumentMatrix(docs)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
d <- data.frame(word = names(v),freq=v)
head(d, 10)
head(d, 10)
View(d)
docs <- tm_map(docs, removeWords, c("the", "and","that","this","with","our"))
dtm <- TermDocumentMatrix(docs)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
d <- data.frame(word = names(v),freq=v)
head(d, 10)
fname <- paste(getwd(),'/','MLK_Dream.txt', sep = '')
text <- readLines(fname, skipNul = F)
docs <- Corpus(VectorSource(text))
inspect(docs)
docs <- tm_map(docs, stripWhitespace)
docs <- tm_map(docs, stemDocument)
excl <- c("the", "and","that","this","with","our","have","from","not","one")
docs <- tm_map(docs, removeWords, excl)
dtm <- TermDocumentMatrix(docs)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
d <- data.frame(word = names(v),freq=v)
head(d, 10)
View(d)
excl <- c("the", "and","that","this","with","our","have","from","not","one",'"')
docs <- tm_map(docs, removeWords, excl)
View(d)
excl <- c("the", "and","that","this","with","our","have","from","not","one",'""','"')
docs <- tm_map(docs, removeWords, excl)
View(d)
excl <- c("the", "and","that","this","with","our","have","from","not","one",'""','”')
docs <- tm_map(docs, removeWords, excl)
d <- data.frame(word = names(v),freq=v)
View(d)
dtm <- TermDocumentMatrix(docs)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
d <- data.frame(word = names(v),freq=v)
View(d)
fname <- paste(getwd(),'/','MLK_Dream.txt', sep = '')
text <- readLines(fname, skipNul = F)
docs <- Corpus(VectorSource(text))
docs <- tm_map(docs, stripWhitespace)
docs <- tm_map(docs, stemDocument)
excl <- c("the", "and","that","this","with","our","have","from","not","one",'"','”')
docs <- tm_map(docs, removeWords, excl)
dtm <- TermDocumentMatrix(docs)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
d <- data.frame(word = names(v),freq=v)
head(d, 10)
View(d)
toSpace <- content_transformer(function (x , pattern ) gsub(pattern, " ", x))
docs <- tm_map(docs, toSpace, "”")
docs <- tm_map(docs, stripWhitespace)
docs <- tm_map(docs, stemDocument)
excl <- c("the", "and","that","this","with","our","have","from","not","one")
docs <- tm_map(docs, removeWords, excl)
dtm <- TermDocumentMatrix(docs)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
d <- data.frame(word = names(v),freq=v)
head(d, 10)
View(d)
docs <- Corpus(VectorSource(text))
toSpace <- content_transformer(function (x , pattern ) gsub(pattern, " ", x))
docs <- tm_map(docs, toSpace, "”")
docs <- tm_map(docs, stripWhitespace)
docs <- tm_map(docs, stemDocument)
docs <- tm_map(docs, removeWords, stopwords("english"))
excl <- c("the", "and","that","this","with","our","have","from","not","one","for")
docs <- tm_map(docs, removeWords, excl)
dtm <- TermDocumentMatrix(docs)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
d <- data.frame(word = names(v),freq=v)
head(d, 10)
View(d)
set.seed(1234)
wordcloud(words = d$word, freq = d$freq, min.freq = 1,
max.words=200, random.order=FALSE, rot.per=0.35,
colors=brewer.pal(8, "Dark2"))
findFreqTerms(dtm, lowfreq = 4)
findFreqTerms(dtm, lowfreq = 4)
findAssocs(dtm, terms = "freedom", corlimit = 0.3)
barplot(d[1:10,]$freq, las = 2, names.arg = d[1:10,]$word,
col ="lightblue", main ="Most frequent words",
ylab = "Word frequencies")
fname <- paste(getwd(),'/','MLK_Dream.txt', sep = '')
text <- readLines(fname, skipNul = F)
docs <- Corpus(VectorSource(text))
docs <- Corpus(VectorSource(text))
View(m)
docs
inspect(docs)
?kmeans
set.seed(1234)
wordcloud(words = d$word, freq = d$freq, min.freq = 1,
max.words=200, random.order=FALSE, rot.per=0.35,
colors=brewer.pal(8, "Dark2"))
View(m)
?tapply
m_n <- t(apply(m, 1, function(x)(x)/(count(x))))
?count
?len
?length
m_n <- t(apply(m, 1, function(x)(x)/(sum(x))))
View(m_n)
View(m)
library(cluster)
agnes(x = TDM.dist, method = "complete")
agnes(x = m_n, method = "complete")
?agnes
plot(hclust, which.plots = 2, main = "", sub = "", xlab = "")
setwd("~/Documents/Text Analysis Pred 453/P454_TextCluster")
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Documents/Text Analysis Pred 453/P454_TextCluster")
library("tm")
library("SnowballC")
library("wordcloud")
library("RColorBrewer")
c_m = read.csv("Conc_Matrix.csv", sep=",", row.names=1)
c_m = read.csv("Conc_Matrix.csv", sep=",", row.names=1)
View(c_m)
c_m <- as.matrix(c_m)
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Documents/Text Analysis Pred 453/P454_TextCluster")
library("tm")
library("SnowballC")
library("wordcloud")
library("RColorBrewer")
c_m = read.csv("Conc_Matrix.csv", sep=",", row.names=1)
c_m <- as.matrix(c_m)
View(c_m)
#tf-idf totals for plotting
v <- sort(rowSums(c_m),decreasing=TRUE)
d <- data.frame(word = names(v),freq=v)
set.seed(1234)
wordcloud(words = d$word, freq = d$freq, min.freq = 1,
max.words=200, random.order=FALSE, rot.per=0.35,
colors=brewer.pal(8, "Dark2"))
View(d)
DSI_label <- 1:40
?hclust
hclust(c_m, labels=DSI_label)
hclust(c_m)
is.na(c_m)
newdata <- na.omit(c_m)
hclust(c_m)
?dist
d_m <- dist(c_m, method="euclidean")
d_m
?hclust
hcl <- hclust(d_m)
hcl
plot(hcl)
plot(hcl, labels = DSI_label)
plot(hcl)
plot(hcl)
pdf("hcl.pdf", width=40, height=15)
plot(hcl)
dev.off()
hcl_cut <- cutree(hcl, 6)
View(d)
table(d$word, clusterCut)
table(d$word, hcl_cut)
hcl_cut
?write.csv
write.csv(table(d$word, hcl_cut), "H_clust.csv")
t <- table(d$word, hcl_cut)
t <- data.frame(table(d$word, hcl_cut))
View(t)
t <- table(d$word, hcl_cut)
t
colSums(t)
hcl_cut <- cutree(hcl, 10)
t <- table(d$word, hcl_cut)
colSums(t)
hcl_cut <- cutree(hcl, 15)
t <- table(d$word, hcl_cut)
colSums(t)
hcl_cut <- cutree(hcl, 20)
t <- table(d$word, hcl_cut)
colSums(t)
hcl_cut <- cutree(hcl, 25)
t <- table(d$word, hcl_cut)
colSums(t)
hcl_cut <- cutree(hcl, 30)
t <- table(d$word, hcl_cut)
colSums(t)
hcl_cut <- cutree(hcl, 20)
t <- table(d$word, hcl_cut)
colSums(t)
hcl_cut <- cutree(hcl, 40)
t <- table(d$word, hcl_cut)
colSums(t)
?paste
nclust = 20
paste("H_clust",nclust, ".csv")
paste("H_clust",nclust, ".csv", sep = "")
#tf-idf totals for plotting
v <- sort(rowSums(c_m),decreasing=TRUE)
d <- data.frame(word = names(v),freq=v)
set.seed(1234)
wordcloud(words = d$word, freq = d$freq, min.freq = 1,
max.words=200, random.order=FALSE, rot.per=0.35,
colors=brewer.pal(8, "Dark2"))
nclust <- 10
hcl_cut <- cutree(hcl, nclust)
t <- table(d$word, hcl_cut)
colSums(t)
write.csv(t, paste("H_clust_firstpass",nclust, ".csv", sep = ""))
nclust <- 10
hcl_cut <-
t <- table(d$word, cutree(hcl, nclust))
t2 <- table(d$word, cutree(hcl, nclust + 10))
t3 <- table(d$word, cutree(hcl, nclust + 20))
colSums(t)
colSums(t2)
colSums(t3)
write.csv(t, paste("H_clust_firstpass",nclust, ".csv", sep = ""))
write.csv(t2, paste("H_clust_firstpass",nclust+10, ".csv", sep = ""))
write.csv(t3, paste("H_clust_firstpass",nclust+20, ".csv", sep = ""))
?hclust
library(cluster)
agnes(x = d_m, method = "complete")
?agnes
plot(h_new)
h_new <- agnes(x = d_m, method = "complete")
plot(h_new)
?hclust
?dist
dsi_m <- t(c_m)
dsi_m
c_m = read.csv("Conc_Matrix.csv", sep=",", row.names=1)
c_m <- as.matrix(c_m)
dsi_m <- t(c_m)
d_m <- dist(c_m, method="euclidean")
dsi_m <- dist(dsi_m, method="euclidean")
hcl <- hclust(d_m)
plot(hcl)
pdf("hcl.pdf", width=40, height=15)
plot(hcl)
dev.off()
hcl2 <- hclust(dsi_m)
plot(hcl2)
pdf("hcl2.pdf", width=40, height=15)
plot(hcl2)
dev.off()
View(d)
View(c_m)
colnames(c_m)
nclust <- 10
t <- table(d$word, cutree(hcl, nclust))
t2 <- table(d$word, cutree(hcl, nclust + 10))
t3 <- table(d$word, cutree(hcl, nclust + 20))
t4 <- table(cutree(hcl2, 6),colnames(c_m))
t4
colSums(t)
colSums(t2)
colSums(t3)
### DSI clusters
write.csv(t4, paste("H_clustDSI_firstpass", ".csv", sep = ""))
write.csv(t3, paste("H_clust_firstpass",nclust+20, ".csv", sep = ""))
nclust <- 10
t <- table(d$word, cutree(hcl, nclust))
t2 <- table(d$word, cutree(hcl, nclust + 10))
t3 <- table(d$word, cutree(hcl, nclust + 20))
t4 <- table(cutree(hcl2, 6),colnames(c_m))
t4
colSums(t4)
### DSI clusters
write.csv(t4, paste("H_clustDSI_firstpass", ".csv", sep = ""))
write.csv(t3, paste("H_clust_firstpass",nclust+20, ".csv", sep = ""))
nclust <- 10
t <- table(d$word, cutree(hcl, nclust))
t2 <- table(d$word, cutree(hcl, nclust + 10))
t3 <- table(d$word, cutree(hcl, nclust + 20))
t4 <- table(cutree(hcl2, 6),colnames(c_m))
colSums(t4)
### DSI clusters
write.csv(t4, paste("H_clustDSI_firstpass", ".csv", sep = ""))
write.csv(t3, paste("H_clust_firstpass",nclust+20, ".csv", sep = ""))
rowSums(t4)
nclust <- 10
t <- table(d$word, cutree(hcl, nclust))
t2 <- table(d$word, cutree(hcl, nclust + 10))
t3 <- table(d$word, cutree(hcl, nclust + 20))
t4 <- table(cutree(hcl2, 8),colnames(c_m))
rowSums(t4)
### DSI clusters
write.csv(t4, paste("H_clustDSI_firstpass", ".csv", sep = ""))
write.csv(t3, paste("H_clust_firstpass",nclust+20, ".csv", sep = ""))
nclust <- 10
t <- table(d$word, cutree(hcl, nclust))
t2 <- table(d$word, cutree(hcl, nclust + 10))
t3 <- table(d$word, cutree(hcl, nclust + 20))
t4 <- table(cutree(hcl2, 10),colnames(c_m))
rowSums(t4)
### DSI clusters
write.csv(t4, paste("H_clustDSI_firstpass", ".csv", sep = ""))
write.csv(t3, paste("H_clust_firstpass",nclust+20, ".csv", sep = ""))
nclust <- 10
t <- table(d$word, cutree(hcl, nclust))
t2 <- table(d$word, cutree(hcl, nclust + 10))
t3 <- table(d$word, cutree(hcl, nclust + 20))
t4 <- table(cutree(hcl2, 12),colnames(c_m))
rowSums(t4)
### DSI clusters
write.csv(t4, paste("H_clustDSI_firstpass", ".csv", sep = ""))
write.csv(t3, paste("H_clust_firstpass",nclust+20, ".csv", sep = ""))
nclust <- 10
t <- table(d$word, cutree(hcl, nclust))
t2 <- table(d$word, cutree(hcl, nclust + 10))
t3 <- table(d$word, cutree(hcl, nclust + 20))
t4 <- table(cutree(hcl2, 15),colnames(c_m))
rowSums(t4)
### DSI clusters
write.csv(t4, paste("H_clustDSI_firstpass", ".csv", sep = ""))
write.csv(t3, paste("H_clust_firstpass",nclust+20, ".csv", sep = ""))
nclust <- 10
t <- table(d$word, cutree(hcl, nclust))
t2 <- table(d$word, cutree(hcl, nclust + 10))
t3 <- table(d$word, cutree(hcl, nclust + 20))
t4 <- table(cutree(hcl2, 10),colnames(c_m))
rowSums(t4)
### DSI clusters
write.csv(t4, paste("H_clustDSI_firstpass", ".csv", sep = ""))
write.csv(t3, paste("H_clust_firstpass",nclust+20, ".csv", sep = ""))
write.csv(t4, paste("H_clustDSI_firstpass", ".csv", sep = ""))
t4 <- table(cutree(hcl2, 10),colnames(c_m))
rowSums(t4)
write.csv(t4, paste("H_clustDSI_firstpass", ".csv", sep = ""))
hcl <- hclust(d_m)
plot(hcl)
pdf("hcl.pdf", width=40, height=15)
plot(hcl)
dev.off()
hcl2 <- hclust(dsi_m)
plot(hcl2)
pdf("hcl2.png", width=40, height=15)
plot(hcl2)
dev.off()
